<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>うなりシミュレーター</title>
  <style>
    body { text-align: center; font-family: sans-serif; }
    canvas { border: 1px solid black; display: block; margin: 0 auto; }
    .controls { margin: 10px; }
  </style>
</head>
<body>
  <h1>うなりシミュレーター</h1>
  <div class="controls">
    f1: <input type="range" id="f1" min="100" max="600" value="440">
    <span id="f1Val">440</span> Hz
    <br>
    f2: <input type="range" id="f2" min="100" max="600" value="442">
    <span id="f2Val">442</span> Hz
  </div>
  <canvas id="canvas" width="800" height="400"></canvas>
  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    const f1Slider = document.getElementById("f1");
    const f2Slider = document.getElementById("f2");
    const f1Val = document.getElementById("f1Val");
    const f2Val = document.getElementById("f2Val");

    let f1 = 440, f2 = 442;
    const sampleRate = 8000;
    const duration = 0.01;

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();

      let N = Math.floor(sampleRate * duration);
      let t, y1, y2, y;
      ctx.strokeStyle = "blue";
      ctx.beginPath();
      for (let i = 0; i < N; i++) {
        t = i / sampleRate;
        y1 = Math.sin(2 * Math.PI * f1 * t);
        let x = (i / N) * canvas.width;
        let yCanvas = canvas.height/2 - y1 * 50;
        if (i === 0) ctx.moveTo(x, yCanvas);
        else ctx.lineTo(x, yCanvas);
      }
      ctx.stroke();

      ctx.strokeStyle = "green";
      ctx.beginPath();
      for (let i = 0; i < N; i++) {
        t = i / sampleRate;
        y2 = Math.sin(2 * Math.PI * f2 * t);
        let x = (i / N) * canvas.width;
        let yCanvas = canvas.height/2 - y2 * 50;
        if (i === 0) ctx.moveTo(x, yCanvas);
        else ctx.lineTo(x, yCanvas);
      }
      ctx.stroke();

      ctx.strokeStyle = "red";
      ctx.beginPath();
      for (let i = 0; i < N; i++) {
        t = i / sampleRate;
        y1 = Math.sin(2 * Math.PI * f1 * t);
        y2 = Math.sin(2 * Math.PI * f2 * t);
        y = y1 + y2;
        let x = (i / N) * canvas.width;
        let yCanvas = canvas.height/2 - y * 50;
        if (i === 0) ctx.moveTo(x, yCanvas);
        else ctx.lineTo(x, yCanvas);
      }
      ctx.stroke();
    }

    function update() {
      f1 = parseFloat(f1Slider.value);
      f2 = parseFloat(f2Slider.value);
      f1Val.textContent = f1;
      f2Val.textContent = f2;
      draw();
    }

    f1Slider.addEventListener("input", update);
    f2Slider.addEventListener("input", update);

    update();
  </script>
</body>
</html>

